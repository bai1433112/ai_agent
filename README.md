
# 多模态 AI 助手
## 项目概述
基于 LangChain 与多模态交互技术构建的智能助手系统，支持语音唤醒、语音对话、图像识别、文档知识库等核心功能，具备工具调用与上下文管理能力，可灵活处理自然语言、语音、图像等多类型输入。
## 核心技术特点
### 1. 多模态交互架构设计
-  **模块化组件解耦** ：将语音处理、图像识别、文本对话拆分为独立模块，通过统一调度中心实现跨模块协同，降低功能迭代时的耦合影响
-  **跨模态数据流转** ：内置语音 - 文本、图像 - Base64 等转换机制，支持多类型输入的无缝衔接处理，例如语音指令触发图像识别任务
-  **统一配置管理** ：通过config.yaml集中管控模型参数、API 密钥、设备索引等配置，支持环境快速切换与个性化定制
### 2. 高效语音交互系统
-  **全链路语音处理** ：实现从唤醒词检测（支持 "小布小布" 等多关键词）、音频录制（最长 15 秒动态时长控制）、本地语音识别（Vosk 模型）到文本转语音（edge-tts）的完整闭环
-  **高可用设计** ：语音合成环节内置重试机制（最多 2 次重试），录音与识别过程采用异常捕获与资源自动释放，保障设备兼容性
-  **流式响应优化** ：通过句子切割算法（基于标点符号与长度阈值）实现文本分段合成语音，减少用户等待感
### 3. 智能文档知识库系统
-  **多格式兼容** ：支持 PDF/CSV/Markdown/TXT/JSON/HTML/XLSX/PY 等 8 类文件解析，满足多样化知识存储需求
-  **自适应文本处理** ：针对不同文件类型采用专用分割策略（如 Python 代码保留语法结构、中文文本按语义断句），提升检索精度
-  **向量检索引擎** ：基于 FAISS 构建本地向量数据库，通过相似度阈值过滤（默认 0.5）确保检索结果相关性，支持增量更新
### 4. 增强型 Agent 智能体
-  **工具链生态** ：集成天气查询、时间获取、网络搜索、导航服务（高德 API）、知识库检索等实用工具，支持工具调用优先级控制（如优先检索本地知识库）
-  **本对话记忆管理** ：通过中间件动态修剪对话历史（最多保留 15 轮），结合 SQLite 实现会话状态持久化，避免上下文超限同时支持断点续聊
-  **指令解析优化** ：严格规范工具调用格式，内置参数校验机制，降低因格式错误导致的调用失败率
### 5. 工程化实现亮点
-  **多线程安全** ：采用线程锁机制保障多模态交互场景下的资源访问安全，避免并发冲突
-  **异常容错设计** ：所有 IO 操作（文件读写、网络请求、设备访问）均实现错误捕获与友好提示，提升系统稳定性
-  **接口化服务** ：通过 FastAPI 提供标准化 HTTP 接口，支持 NLP / 语音 / 图像三种模式切换，便于前端集成
## 使用指南
### 快速启动
 **1. 环境准备** ：配置 Python 3.8 + 环境，安装依赖包，放置 Vosk 语音模型与 embedding 模型到指定路径
 **2. 配置调整** ：修改config.yaml中的 API 密钥、模型名称、设备索引等参数
 **3. 启动服务** ：运行主程序后，可通过三种方式交互：
    -  **NLP 模式** ：直接发送文本指令获取回复
    -  **语音模式** ：发送 "开始语音监听" 指令，说出唤醒词后进行语音对话
    -  **图像模式** ：传入图像 Base64 编码与描述文本，获取图像理解结果
### 知识库管理
1. 将要导入的文档放入指定目录，支持批量处理
2. 系统自动完成文本分割与向量索引构建，生成的 FAISS 索引文件保存在本地
3. 提问时会自动优先检索知识库内容，再补充网络搜索结果
## 后续优化方向
 **1. 模型轻量化** ：引入量化模型（如 4-bit 量化的语音识别模型），降低硬件资源占用，支持移动端部署

 **2. 交互体验升级** ：
    - 增加语音合成情感调节（根据对话内容调整语速、语调）
    - 实现图像实时流处理（当前仅支持单张图像）

 **3. 智能调度优化** ：
- 基于用户行为分析工具调用优先级
- 增加缓存机制减少重复计算（如近期天气、固定路线导航）

**4. 多轮对话增强** ：
- 优化上下文理解能力，支持跨模态指代消解（如 "这个图像里的物体是什么"）
- 增加对话主题追踪，避免答非所问

**5. 扩展性提升** ：
- 设计插件化架构，支持第三方工具快速接入
- 增加多语言支持，扩展使用场景
